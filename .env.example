# OT EWS - Environment template
# Copy this file to .env and edit values for your plant/network.
# Use FULL MODE with docker-compose.full.yml or LIGHT MODE with docker-compose.light.yml.

#############################################
# COMMON
#############################################
# Web UI port (HTTP plain, no TLS)
EWS_WEB_PORT=8080

# Event dedup window in seconds
EWS_DEDUP_WINDOW_SECONDS=30

# Days to keep events before automatic purge (default: 30)
EWS_EVENTS_RETENTION_DAYS=30

# Time window in seconds for "recent" metrics on the dashboard (default: 600)
EWS_RECENT_WINDOW_SECONDS=600

#############################################
# SECURITY / ALERTING
#############################################
# API key for mutating endpoints (leave empty to disable auth â€” dev/test only)
EWS_API_KEY=

# Webhook URL for external ALARM forwarding (Slack, SIEM, syslog relay, etc.)
EWS_WEBHOOK_URL=

#############################################
# PORT SCAN DETECTION
#############################################
# Trigger ALARM if a single IP contacts >= N distinct ports in the time window
EWS_SCAN_THRESHOLD_PORTS=5
EWS_SCAN_THRESHOLD_SECONDS=60

# Max events recorded per second (rate limiter, 0 = unlimited)
EWS_EVENT_RATE_LIMIT=100

#############################################
# FULL MODE (eth0 + eth1) - docker-compose.full.yml
#############################################
# Static IP of container on OT/MGMT network (eth0)
EWS_ETH0_IP=192.168.10.250

# Parent interface on Docker host for OT/MGMT macvlan (normal switch port)
OT_MGMT_PARENT_IFACE=eth0
OT_MGMT_SUBNET=192.168.10.0/24
OT_MGMT_GATEWAY=192.168.10.1

# Parent interface on Docker host for SPAN/mirror macvlan (read-only sniffing)
OT_SPAN_PARENT_IFACE=eth1

#############################################
# LIGHT MODE (only eth0) - docker-compose.light.yml
#############################################
# Keep OT/MGMT values above; OT_SPAN_PARENT_IFACE is not used in light mode.

#############################################
# OPTIONAL (advanced / rarely changed)
#############################################
# Interface names INSIDE the container (usually no need to change)
# EWS_ETH0_IFACE=eth0
# EWS_ETH1_IFACE=eth1
# EWS_DATA_DIR=/data
